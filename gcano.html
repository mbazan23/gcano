<!DOCTYPE html>
<html lang="en">

<head>
  <title> WebSocket Server </title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap CSS -->
   <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<link rel="stylesheet"  href="estilo.css">



<body>

<div class="container" >
	<div class="row h-100 justify-content-center align-items-center" >
		<div class="col-5 formu" >
			<div class="mt-lg-5"></div>
				<img class="img-fluid" src="secureAuth.jpg" alt="Chania">
			<div class="mt-lg-5"></div>
			<div class="mt-lg-5"></div>
			<form action=""  id="form_session" method="post" onsubmit="var object =  new Main; object.sendData();" autocomplete="off">

				<div class="row" >
				  <div class="col-6">
					<div class="form-group row">
						<label for="client" >Client ID</label>
						<input class="form-control" type="text"  placeholder="Client ID *" id="client" aria-describedby="clienthelper" required > <br/>
					</div>
				  </div>
				  <div class="col-5 offset-md-1">
					<div class="form-group row">
					<label for="port">Port</label>
					  <input class="form-control" type="number" placeholder="Port *" id="port" required min ="1" max"65000" maxlength="5"> <br/>
					</div>
				  </div>
				</div>
				
				<div class="row">
					<div class="col-6">
					  <div class="form-group row">
					  <label for="server_host">Server Host</label>
						<input class="form-control" type="text"  placeholder="Server Host *" id="server_host" aria-describedby="serverhosthelper"required> <br/>
					  </div>
					</div>
					<div class="col-5 offset-md-1">
					  <div class="form-group row">
					  <label for="server_port">Server Port</label>
						<input class="form-control" type="number"  placeholder="Server Port *" id="server_port" required min ="1" max"65000" maxlength="5"> <br/>
					  </div>
					</div>
				 </div>

				<div class="row">
					<div class="col-12">
						<div class="form-group row">
						<label for="end_point" class="control-label">Endpoint</label>
							<input class="form-control" type="text"  placeholder="Endpoint" id="end_point" > <br/>
						</div>
					</div>
				</div>
					
				<div class="row">
					<div class="col-6">
					  <div class="form-group row">
					  <label for="proxy_ip" class="control-label">Proxy IP</label>
						<input class="form-control" type="text"  placeholder="Proxy IP" id="proxy_ip" > <br/>
					  </div>
					</div>
					<div class="col-5 offset-md-1">
						<div class="form-group row">
						<label for="proxy_port" class="control-label">Proxy Port</label>
						  <input class="form-control" type="number" placeholder="Proxy Port" id="proxy_port" min ="1" max"65000" maxlength="5"> <br/>
						</div>
					</div>
				</div>
				
				<div class="mt-lg-3"></div>
				
				<div class="form-group row h-100 justify-content-center align-items-center">
					<button type="submit" class="btn btn-primary" >  UPDATE RULES  </button>
				</div>

			</form>
		</div>
	</div>
</div>
    
<script src="jquery.js"></script>
<script>
   function Main(){
     var clientValue= document.getElementById('client').value;
     var porttValue= document.getElementById('port').value;
     var server_hostValue= document.getElementById('server_host').value;
     var server_portValue= document.getElementById('server_port').value;
     var end_pointValue= document.getElementById('end_point').value;
     var proxy_ipValue= document.getElementById('proxy_ip').value;
     var proxy_portValue= document.getElementById('proxy_port').value;

     function isNumber(n) {
     return !isNaN(parseFloat(n)) && isFinite(n);
     }

     function validateIP(ipaddress) {
       if (/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(ipaddress))
       {
         return (true)
       }
       alert("You have entered an invalid IP address!")
       return (false)
     }

     function validatePort(portNumber){
           if(!isNumber(portNumber)){
             alert('Invalid Port number');
             return false;
           }
           if (portNumber.length > 5 ){
            alert('Invalid Port number(max 5 digits)')
             return false
           }
           return true;
     }

    this.validatePORTS= function() {
       (validatePort(porttValue) && validatePort(server_portValue) && validatePort(proxy_portValue))
    }

    this.validateIPS= function() {
       (validateIP(server_hostValue) && validateIP(proxy_ipValue))
    }


      this.sendData= function(){
        var propertiesJSON = {
          client: clientValue,
          server_host:server_hostValue,
          server_port:server_portValue,
          end_point:end_pointValue,
          proxy_host:proxy_ipValue,
          proxy_port:proxy_portValue
        }
        var propertiesSring = JSON.stringify(propertiesJSON);
        alert(propertiesSring);


        $.ajax({
            url: 'http://127.0.0.1:8080/properties',
            type: "post",
            data:{content: propertiesSring},
            success: function(response){
              alert(response);
            }
        });

        return false
      }

  }
    </script>

  </body>
  </html>
